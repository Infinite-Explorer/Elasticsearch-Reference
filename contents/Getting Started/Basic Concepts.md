## Basic Concepts

ES有一些核心概念。一开始理解这些概念会是大大轻松你的学习过程。

### 准实时（NRT）

ES是一个准实时的搜索平台。意味着从你索引一个文档到该文档能被搜索有明显的延迟（通常为1秒）。

### 集群

一个集群就是一个或者多个节点(服务器)的集合。这些节点拥有所有的数据，并且通过所有节点提供了联合索引和查询的能力。集群通过一个唯一的名称来鉴别，默认为“elasticsearch”。这个名称是重要的，因为如果一个节点是通过名称加入一个集群，那么只能属于该集群。

确保你不会在不同的环境重复使用相同的集群名称，否则可能会导致节点加错集群。例如使用`logging-dev`,`logging-stage`,`logging-prod`分别作为开发，测试和生产环境集群。

记住一个集群只有一个节点既是可行的，又是非常好的。此外，你也可以有多个独立的节点，各自拥有唯一的集群名称。
### 节点

一个节点就是一台单独的服务器，集群的一部分，存储数据，参与提供集群的所有和搜索功能。跟集群一样，节点也是通过一个名称鉴别，默认是在节点启动时被分配的一个随机漫威角色的名字作为名称。如果你不想要默认的名称可以自己定义。节点名称对于想判断节点对应哪一个服务器的管理目的来说是重要的。

节点可以通过配置集群名称加入一个特定集群。默认情况下，每个节点会加入叫做`elasticsearch`的集群。意味着如果你在网络中启动了很多节点，并且假设节点间都能互相发现，这些节点全部都会自动加入到`elasticsearch`集群中。

在一个单独的集群中，你可以有尽可能多的节点。此外，如果网络中此时没有运行其他ES节点，启动一个节点会默认形成一个新的叫做`elasticsearch`的单节点集群。

### 索引

索引就是有着某些相似特征的文档集合。例如：你可以有一个用户数据索引，一个产品目录索引，一个订单数据索引。索引通过名称（必须全小写）来辨别，并且这个名称会在对该索引中想文档执行索引，搜索，更新和删除操作时用到。
在单独的集群中，你可以定义尽可能多的索引。

### 类型
在索引中，你可以定义一个或多个类型。类型是索引的逻辑目录或分区，它的名称完全由你决定。一般而言，类型是根据一系列相同字段的文档定义的。例如，假设你运营一个博客平台并且把所有的数据存储在一个索引中。在这个索引中你可能会为用户数据定义一个类型，博客数据定义一个类型，评论数据定义一个类型。

### 文档

文档是可被索引信息的基本单元。例如，你可以有一个单个用户的文档，单个产品的文档，单个订单的文档。文档以[JSON](http://json.org/)(JavaScript Object Notation)展示，JSON是一个主流的互联网数据交互格式。
分片和副本

一个索引可能会存储超过单个节点硬件限制的大量数据。例如，包含10亿文档，占用1TB硬盘空间的单个索引可能不适合放在单个节点的硬盘上或者会单独一个节点查询服务会很慢。
为了解决这个问题，ES提供了把所有分到多个分片的能力。创建索引的时候,可以只定义你想要的分片数。每个分片自身都是能被集群中任一节点访问的全功能的独立的“索引”。
分片重要的原因有两个：

* 分片允许横向扩展内容容量
* 分片允许在多个分片（可能在多个节点上）间分发和并行操作，以此提高了性能或性能。

分片如何分配和文档如何聚合请求结果完全由ES管理，并且对用户也是透明的。
在网络或云环境中，失败随时都会发生，所以有一个以防分片或节点因某种原因，以某种方式离线或消失的故障转移机制是非常有用和强烈推荐的。为此，ES允许创建索引分片的一个或多个备份到副本分片，或者简称副本。

复制重要的原因有两个：

* 在分片或节点挂掉的时候提供了高可用性。因此，谨记副本分片决不能分配到其主分片的相同节点上。
* 由于ES可以在所有的副本上并行执行，所以可以扩展搜索的容量或吞吐量。

总结一下，每个索引都可以被分到多个分片。索引可以被复制0或更多次。一旦被复制，每个索引可以有主分片（被复制的原始分片）和副分片（主分片的拷贝）。每个索引的主分片和副分片数量可以在索引创建的时候设置。索引创建之后，你可以在任何时候动态修改副本，但是不能修改分片的数量。

默认的，ES中的每个索引被分配了5个主分片和一个副本，这意味着如果你在集群中至少有2个节点，每个索引总共会有10个分片：5个主分片和5个副本分片（1个完整的副本）。

# 注意

每个ES分片都是一个Lucene索引。单个Lucene索引有最大的文档数量。对于[LUCENE-5843](https://issues.apache.org/jira/browse/LUCENE-5843)，限制是2,147,483,519(=Integer.MAX_VALUE - 128)个文档。你可以通过接口[_cat/shards](https://www.elastic.co/guide/en/elasticsearch/reference/current/cat-shards.html)监控节点大小。

概念搞清楚了之后，我们就开始有趣的部分...
